pipeline {
  //agent { dockerfile true }
  agent any
  stages {
    stage('branch main') {
      steps {
        //dir('var') {
          script {
             def payload = currentBuild.rawBuild.getRequest().getContent()
                     
            // แปลง JSON payload
            def json = readJSON text: payload
            
            // ดึงข้อมูลที่จำเป็นจาก payload
            def eventType = json['action']
            echo "Event : branch main"
  
            //sh '''
                //ls -l
                //git status
                //git branch
            //'''
            //sh "printenv | sort"
          }
        //}
      }
    }
    stage('branch hook') {
      when {
          branch 'test-hook'
      }
      steps {
          script {
            
            echo "Event : branch test-hook"
          }
      }
    }
  }
}
